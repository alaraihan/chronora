<link rel="stylesheet" href="/css/user/order-failure.css" />

<div class="failure-wrapper">
  <div class="failure-container">
    <div class="failure-icon">
      <i class="fas fa-times-circle"></i>
    </div>

    <h1 class="failure-title">Payment Unsuccessful</h1>

    <p class="failure-message">
      We couldn't process your payment. But don't worry, your selection is reserved and your cart is safe.
    </p>

    <% if (errorMessage) { %>
      <div class="error-detail">
        <span class="detail-label">Issue:</span>
        <span class="detail-text">
          <%= errorMessage %>
        </span>
      </div>
      <% } %>

        <div class="order-summary-card">
          <h3>Order Detail</h3>
          <div class="summary-row">
            <span>Subtotal</span>
            <span>₹<%= subtotal.toLocaleString('en-IN') %></span>
          </div>
          <div class="summary-row">
            <span>Shipping</span>
            <span>
              <%= shipping===0 ? 'Complimentary' : '₹' + shipping.toLocaleString('en-IN') %>
            </span>
          </div>
          <% if (discount> 0) { %>
            <div class="summary-row discount">
              <span>Privilege Discount</span>
              <span>- ₹<%= discount.toLocaleString('en-IN') %></span>
            </div>
            <% } %>
              <div class="summary-total">
                <span>Total Amount</span>
                <strong>₹<%= totalAmount.toLocaleString('en-IN') %></strong>
              </div>
        </div>

        <div class="action-buttons">
          <% if (orderRecId) { %>
            <button class="btn-primary" onclick="retryPayment('<%= orderRecId %>', <%= totalAmount %>)">
              <i class="fas fa-redo"></i> Retry Payment Now
            </button>
            <% } %>

              <div class="secondary-actions">
                <a href="/cart" class="btn-secondary">
                  <i class="fas fa-shopping-cart"></i> View Cart
                </a>
                <a href="/" class="btn-outline">
                  <i class="fas fa-home"></i> Home
                </a>
              </div>
        </div>
  </div>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="/js/user/orders.js"></script>